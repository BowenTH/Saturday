<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="../../../../common/mui.css"/>
		<script src="../../../../common/mui.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../../common/jquery.js" type="text/javascript" charset="utf-8"></script>
		<script src="foodMenu.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css">
			*{padding: 0;margin: 0;}
			li{padding: 10px;}
			ul{background: ;}
			li{list-style: none;}
			ul a{padding: 5px;}
			.sigle{padding-left: 20px;font-size: 12px;}
			.a-active{position: fixed;}
		</style>
	</head>
	<body>
		<template id="temp_detail">
			<li class="mui-table-view-cell">
				<img src="../../../../img/s3.jpg"style="width: 30px;height: 20px;border-radius: 20%;"/>
		   		<span class="food-type">粉木耳<span class="sigle">12</span></span>			   		
		   		<div class="mui-numbox" style="float: right; display: none;" >
					<button class="mui-btn mui-btn-numbox-minus"  type="button">-</button>
					<input id="countInput" class="mui-input-numbox" type="number" value="1">
					<button class="mui-btn mui-btn-numbox-plus" type="button">+</button>
				</div>
				<span class="mui-icon mui-icon-plus mui-icon-plus-filled" style="color: red;float: right;font-size: 35px;" ></span>
	      		<h6 style="color: greenyellow;">限时优惠，满20元立减25，亏本甩卖</h6>
		    	<pre>
		    		
		    		
		    		
		    		
		    	</pre>
			</li>
		</template>
		<div id="left-side" style="float:left;position:fixed;width: 50px;height: 500px;">
			<!--<ul>
				<li data-id = "1">热销</li>				
			</ul>
			<ul>
				<li data-id = "2">冷饮</li>				
			</ul>
			<ul>
				<li data-id = "3">热饮</li>				
			</ul>-->
				<div class="mui-checkbox">
					<div class="chat-content">
						<div class="chat-content-inner">
							
						</div>
					</div>
				</div>
		</div>
		<div class=""style="margin-left: 50px;">		
				<!--<h6>热销</h6>-->
				<ul id='fdUL' class="mui-table-view" style="padding-bottom: 200px;">
				   <!--<li class="mui-table-view-cell">
					<h4><a id = "1" >热销</a></h4>
					<img src="../../../../img/s3.jpg"style="width: 30px;height: 20px;border-radius: 20%;"/>
			   		<span class="food-type">粉木耳</span>			   		
			   		<div class="mui-numbox" style="float: right; display: none;" >
						<button class="mui-btn mui-btn-numbox-minus"  type="button">-</button>
						<input id="countInput" class="mui-input-numbox" type="number" value="1">
						<button class="mui-btn mui-btn-numbox-plus" type="button">+</button>
					</div>
					<span class="mui-icon mui-icon-plus mui-icon-plus-filled" style="color: red;float: right;font-size: 35px;" ></span>
		      		<h6 style="color: greenyellow;">限时优惠，满20元立减25，亏本甩卖</h6>
			    </li>
				<li class="mui-table-view-cell mui-media">
					<img src="../../../../img/s3.jpg"style="width: 30px;height: 20px;border-radius: 20%;"/>
			   		<span class="food-type">紫葡萄</span>
			   		<div class="mui-numbox" style="float: right; display: none;" >
						<button class="mui-btn mui-btn-numbox-minus"  type="button">-</button>
						<input class="mui-input-numbox" type="number"id="countInput" value="1">
						<button class="mui-btn mui-btn-numbox-plus" type="button">+</button>
					</div>
					<span class="mui-icon mui-icon-plus mui-icon-plus-filled" style="color: red;float: right;font-size: 35px;" ></span>
		      		<pre>
			   			
			   			
			   			
			   		</pre>
					<h6 style="color: greenyellow;">限时优惠，满20元立减25，亏本甩卖</h6>
			    </li>   
			    <li class="mui-table-view-cell mui-media">
					<img src="../../../../img/s3.jpg"style="width: 30px;height: 20px;border-radius: 20%;"/>
			   		<span class="food-type">香蕉</span>
			   		<pre>
			   			
			   			
			   			
			   		</pre>
					<h6 style="color: greenyellow;">限时优惠，满20元立减25，亏本甩卖</h6>
			    </li>   
					<h4><a id = "2" >冷饮</a></h4>						
			    <li class="mui-table-view-cell mui-media">
					<img src="../../../../img/s3.jpg"style="width: 30px;height: 20px;border-radius: 20%;"/>
			   		<span class="food-type">瓜子</span>
			   		<pre>
			   			
			   			
			   			
			   		</pre>
					<h6 style="color: greenyellow;">限时优惠，满20元立减25，亏本甩卖</h6>
			    </li>   -->

			</ul>
		</div>		
		
	
		<div id='blank-shopcar' style="display: none;padding: 15px; height: 50px;width: 100%; position: fixed; bottom: 80px;background: gray;">
			<span style="margin-top: 10px;color: white;">购物车是空的</span><span style="float: right;">20元起送</span>
		</div>
		<!--menu list关闭开启-->
		<div id="menu-list"style="display: none;width: 60%;bottom: 130px;position: fixed;">
			<ul class="mui-table-view">
			</ul>
		</div>
		<div id="">		
			<button id="menu" type="button" class="mui-btn-grey"style="height: 50px;border-radius: 0;;width: 60%;position: fixed;bottom: 80px;">
				<span>菜单<span id="count-list" style="margin: -10px;" class="mui-badge mui-badge-red mui-btn-red mui-pull-right ">0</span></span>
			</button>
		        <button id="go" style="height: 50px;width: 40%;right: 0;background:lightblue;bottom: 80px;position: fixed;">
		         	<span id="" >
						结账：<span id='sum-finally'>0</span>元
					</span>					
		        </button>			
		</div>
	
		<script type="text/javascript">
		mui.init();
		//按下加号促发
		var listcount=0;
		var foodsum=0;
//		mui('#fdUL').on('change','.mui-input-numbox',function(){
//			var flag=null;
//			alert($(this).val());
//		});
		mui('#fdUL').on('tap','.mui-btn-numbox-plus',function(){
			var flag=$(this).siblings('.mui-input-numbox').val();
			flag++;
			$(this).siblings('.mui-input-numbox').val(flag);
			listcount++;//购买菜单种类加1; 
			var sigle=$(this).parent().siblings('.food-type').children().text();
			
			var data=parseInt(sigle);
			foodsum+=data;//总额	 
			$('#sum-finally').text(foodsum);
			$('#count-list').text(listcount);			
			//动态添加menulist的数目 1，2，3，4			
			var listname=$(this).parent().siblings('.food-type').text();
//			var span =$('#menu-list li');
			var span= $("#menu-list ul li:contains("+listname+")");
			$(span).children('span').last().text(flag);
		});
		
		mui('#fdUL').on('tap','.mui-btn-numbox-minus',function(){
			var flag=$(this).siblings('.mui-input-numbox').val();
			flag--;
			$(this).siblings('.mui-input-numbox').val(flag);
			if ($(this).siblings('.mui-input-numbox').val()<0) {//numbox值不能小于0
				$(this).siblings('.mui-input-numbox').val(0);
				return; 
			}
			listcount--;//如果不买该种类水果，listcount--；
			var sigle=$(this).parent().siblings('.food-type').children().text();
			var data=parseInt(sigle);
			foodsum-=data;//总额			
			$('#sum-finally').text(foodsum);
			$('#count-list').text(listcount);
			//动态添加menulist的数目 1，2，3，4
			var listname=$(this).parent().siblings('.food-type').text();
			var span= $("#menu-list li:contains("+listname+")");
			$(span).children('span').last().text(flag);
		});

		mui('#fdUL').on('tap','.mui-icon-plus-filled',function(){
			this.style.display='none'; 
//			input里显示购买量
			$(this).siblings('.mui-numbox').css({'display':'inline'});
			var sigle=$(this).siblings('.food-type').children().text();
			var data=parseInt(sigle);
			listcount++;//购买菜单种类加1;
			foodsum+=data;
			$('#sum-finally').text(foodsum);
			$('#count-list').text(listcount);
		//加入菜单主列表
			var li = document.createElement('li');
			$(li).addClass('mui-table-view-cell food-type');
			var foodcount=$(this).siblings().children('.mui-input-numbox').val();//1
			li.dataset.foodcount=foodcount;//1
			li.dataset.listname = $(this).parent().find('.food-type').html();//粉木耳
			//添加菜单列表具体内容 foodcount为一单个数
			li.innerHTML= li.dataset.listname+'<span class="mui-badge mui-badge-green mui-btn-green mui-pull-right ">'+li.dataset.foodcount+'</span>';
			document.body.querySelector('#menu-list ul').appendChild(li);
		});
		var flag=0;
		document.getElementById('menu').addEventListener('tap',function(){
			if(!flag){
				$('#menu-list').css("display","block");
				flag=1;
			}else{
				$('#menu-list').css("display","none");
				flag=0;
			}
		});
		mui('#left-side').on('tap','li',function(){
			var tapli=$(this).text();
			var tapH =$('#fdUL h5:contains('+tapli+')');			

//			$(this).css({'color':'red','background':'white'});
			$(window).scrollTop($(tapH).offset().top); 
		});

		var hList=[];
		
		function InitHheight(){			
			var hdata=$('#left-side').children('li');
			var tapH =$('#fdUL h5:contains('+'tapli'+')');
//			hdata = document.getElementsByTagName('h5');
//			alert(typenum);
			for (var i=0;i<hdata.length;i++) {
				hList[i]=$('#fdUL h5:eq('+i+')').offset().top;
				console.log($('#fdUL h5:eq('+i+')').offset().top);
			}
		}
		InitHheight();
//		var height=$('#2').offset().top;//固定的高度
//		$(window).scroll(function(){
//			var $me=$(this); 
////			var fixheight=$(this).height();//滚动条的高度
//			for (var j=0;j<hList.length;j++) {
//				if($me.scrollTop()==hList[j]){
//					$('#left-side ul:eq('+j+')').css({'color':'red','background':'white'});
//					for(var t=0;t<hList.length;t++){
//						if(t!=j){
//							$('#left-side ul:eq('+t+')').css({'color':'black','background':'#efeff4'});
//						}
//					}
//				}
//			}
//					if($me.scrollTop()==height-3){
//						console.log($me.scrollTop()+':'+$me.height()+":"+height);
//						console.log($('#2').scrollTop());
//						//$me.scrollTop(0);
//						$('#left-side ul:eq(0)').css({'color':'black','background':'#efeff4'});
//						$('#left-side ul:eq(1)').css({'color':'red','background':'white'});
//					}else{
//						$('#left-side ul:eq(0)').css({'color':'red','background':'white'});
//						$('#left-side ul:eq(1)').css({'color':'black','background':'#efeff4'});
//					}
//		});
		</script>
	</body>
</html>
